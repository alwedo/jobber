<!doctype html>
<html lang="en">
    <head>
        <title>jobber</title>
        <script src="https://unpkg.com/htmx.org@1.9.10"></script>
        <style>
            .centered-form {
                display: block;
                margin: 0 auto;
                text-align: center;
            }

            .htmx-indicator {
                opacity: 0;
                visibility: hidden;
            }
            .htmx-request .htmx-indicator,
            .htmx-request.htmx-indicator {
                opacity: 1;
                visibility: visible;
                transition: opacity 200ms ease-in;
            }

            #content.htmx-indicator {
                opacity: 1;
                visibility: visible;
                transition: opacity 200ms ease-in;
            }
            #content.htmx-request #content.htmx-indicator,
            #content.htmx-request.htmx-indicator {
                opacity: 0;
                visibility: hidden;
            }

            .copy-button {
                margin-left: 10px;
                padding: 5px 10px;
                background: #007bff;
                color: white;
                border: none;
                border-radius: 3px;
                cursor: pointer;
            }

            .copy-feedback {
                display: block;
                color: #28a745;
                font-size: 14px;
                margin-top: 5px;
                opacity: 0;
                transition: opacity 0.3s ease-in-out;
            }

            .copy-feedback.show {
                opacity: 1;
            }
        </style>
    </head>
    <body>
        <div class="centered-form">
            <p>Bring them jobs to me!</p>

            <div id="content" class="spinner htmx-indicator">
                <form
                    style="display: inline"
                    hx-post="/feeds"
                    hx-indicator=".spinner"
                    hx-target="#content"
                    hx-swap="innerHTML"
                >
                    <input
                        type="text"
                        name="keywords"
                        placeholder="Keywords"
                        required
                    />
                    <input type="text" name="location" placeholder="Location" />
                    <button type="submit">Create RSS Feed</button>
                </form>
            </div>
            <p class="spinner htmx-indicator">Loading...</p>
        </div>

        <footer>
            <br />
            <p style="text-align: center">- jobber -</p>
        </footer>

        <script>
            function copyToClipboard(url) {
                navigator.clipboard
                    .writeText(url)
                    .then(() => {
                        showCopyFeedback();
                    })
                    .catch((err) => {
                        console.error("Failed to copy: ", err);
                        showCopyFeedback("Failed to copy");
                    });
            }

            function showCopyFeedback(message = "Copied!") {
                let feedback = document.querySelector(".copy-feedback");
                if (!feedback) {
                    feedback = document.createElement("div");
                    feedback.className = "copy-feedback";
                    document
                        .querySelector(".copy-button")
                        .parentNode.appendChild(feedback);
                }
                feedback.textContent = message;
                feedback.classList.add("show");
                setTimeout(() => {
                    feedback.classList.remove("show");
                }, 2000);
            }
        </script>
    </body>
</html>
